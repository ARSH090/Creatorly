version: "2"
type: backend
tech_stack:
  - TypeScript
  - Next.js 14 (App Router)
  - MongoDB (Mongoose)
  - Clerk (Auth)
  - Razorpay, Stripe, PayPal (Payments)
  - Resend, BullMQ (Email & Queues)
  - AWS S3 (Storage)
  - Socket.io (Real-time)
features:
  - name: Authentication (Clerk)
    description: User registration, login, and session management via Clerk.
    files:
      - src/lib/auth/server-auth.ts
      - src/middleware.ts
    endpoints:
      - method: GET
        path: /api/auth/me
        description: Fetch current authenticated user profile
        auth_required: true
  - name: Product Management
    description: Creator-facing CRUD for digital products, including file uploads and pricing.
    files:
      - src/app/api/products/route.ts
      - src/lib/models/Product.ts
    endpoints:
      - method: GET
        path: /api/products
        description: List creator's products
        auth_required: true
      - method: POST
        path: /api/products
        description: Create new digital product
        auth_required: true
  - name: Payment Webhooks
    description: Listeners for Razorpay, Stripe, and PayPal payment success events to trigger fulfillment.
    files:
      - src/app/api/webhooks/razorpay/route.ts
      - src/app/api/webhooks/stripe/route.ts
      - src/lib/services/digitalDelivery.ts
    endpoints:
      - method: POST
        path: /api/webhooks/razorpay
        description: Handle Razorpay payment captured events
        auth_required: false
  - name: Admin Dashboard
    description: Platform-wide management of users, stores, payouts, and system settings.
    files:
      - src/app/api/admin/users/route.ts
      - src/app/api/admin/payouts/route.ts
      - src/app/api/admin/settings/route.ts
      - src/lib/models/AuditLog.ts
    endpoints:
      - method: GET
        path: /api/admin/analytics
        description: Platform-wide revenue and growth metrics
        auth_required: true
      - method: PATCH
        path: /api/admin/users/[id]/suspend
        description: Suspend/Unsuspend user store
        auth_required: true
  - name: Digital Delivery
    description: Secure delivery of files, license keys, and course access after purchase.
    files:
      - src/app/api/download/[token]/route.ts
      - src/lib/models/DownloadToken.ts
    endpoints:
      - method: GET
        path: /api/download/[token]
        description: Download purchased digital asset
        auth_required: false
known_limitations: []
