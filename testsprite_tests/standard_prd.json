{
  "meta": {
    "project": "Creatorly",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Creatorly is a creator-first platform that lets creators launch a public storefront, sell digital products and services, automate DMs and emails, and manage subscriptions â€” all from a single dashboard. Public storefronts are server-rendered for fast load and creators can fully customize theme, layout and content from their dashboard.",
  "core_goals": [
    "Enable creators to launch a public storefront (creatorly.link/{username}) in under 10 minutes with no code.",
    "Provide an integrated commerce flow: product creation, Razorpay checkout, webhook-verified order creation and secure S3 delivery.",
    "Offer easy storefront customization with drag-and-drop ordering, theme controls and media upload.",
    "Automate marketing and engagement via AutoDM and email sequences with queueing, deduplication and retry logic.",
    "Support subscription billing and trials via Razorpay webhooks with robust security and idempotency.",
    "Provide admin tools for managing users, plans and webhook logs."
  ],
  "features": [
    {
      "name": "Onboarding & Authentication",
      "description": "Five-step creator onboarding including username selection, personal details, OTP verification, plan selection and Razorpay mandate to start a 14-day trial. Protects /dashboard routes until onboardingComplete is true.",
      "user_flows": [
        "Navigate to /onboarding -> Fill 'Username' field (creatorly.link/[username]) -> Click 'Check availability' -> See 'username available' indicator -> Fill Personal Details (name, email, +91 phone) -> Click 'Send OTP' -> Receive 6-digit SMS OTP -> Fill OTP input boxes -> Click 'Verify' -> Select Plan (Starter/Pro/Business) -> Click 'Start Trial / Continue to Payment' -> Complete Razorpay mandate flow -> See 'Onboarding complete' -> Redirect to /dashboard",
        "Navigate to /onboarding -> Fill 'Username' field -> Click 'Check availability' -> See 'username taken' error -> Change username -> See 'username available' indicator -> Cannot proceed until unique username is chosen",
        "Navigate to /onboarding -> Fill phone and click 'Send OTP' -> Receive OTP -> Enter wrong OTP three times -> See 'Too many attempts, try again in 10 minutes' lockout"
      ]
    },
    {
      "name": "Public Storefront",
      "description": "Public creator profile page at /u/[username] showing bio, social links, products (grid/list), bookings, testimonials and CTAs. No auth required; server-rendered for performance and SEO.",
      "user_flows": [
        "Navigate to /u/[username] -> View creator bio and social links -> Scroll to Products Grid -> Switch between Grid and List product layouts -> Click product card -> See product detail modal or drawer -> Click 'Buy Now' -> Checkout starts",
        "Navigate to /u/[username] -> View products -> Click product card for unpublished product -> See 'Coming soon' or 404 message (product not available)"
      ]
    },
    {
      "name": "Storefront Customization (Creator Dashboard)",
      "description": "Creators edit theme, colors, banner/profile images, profile visibility and reorder sections via drag-and-drop from /dashboard/storefront. Changes persist via API calls and can be published/unpublished.",
      "user_flows": [
        "Navigate to /dashboard/storefront -> Click 'Theme' tab -> Click primary color picker -> Select a primary color -> Click background color picker -> Select a background color -> Click 'Save' -> See 'Changes saved' confirmation",
        "Navigate to /dashboard/storefront -> Click 'Upload background image' -> Select image file -> Upload begins -> POST to /api/creator/upload executes -> See uploaded banner preview -> Click 'Save' -> See 'Saved' confirmation",
        "Navigate to /dashboard/storefront -> Click 'Upload background image' -> Select file -> Upload fails due to missing S3 credentials -> See 'Upload failed: S3 not configured' error (uploads will fail if S3 credentials not set)"
      ]
    },
    {
      "name": "Product Management",
      "description": "Creators create, edit, reorder and publish digital products from the dashboard; file uploads use S3 presigned URLs and products include metadata for price, download limits, and expiry.",
      "user_flows": [
        "Navigate to /dashboard -> Click 'Create Product' -> Fill name, description, price and select product type -> Click 'Upload file' -> Request presigned URL via POST /api/upload/product-file -> Upload file to S3 using presigned URL -> See thumbnail preview -> Click 'Publish' -> See product listed in ProductGrid",
        "Navigate to /dashboard -> Open product list -> Drag product to reorder -> Click 'Save order' -> PUT /api/products/reorder called -> See 'Order saved' confirmation",
        "Navigate to /dashboard -> Click 'Create Product' -> Fill fields -> Click 'Upload file' -> Presigned URL request fails -> See 'File upload failed' error and file not attached -> Product creation blocked until file upload succeeds"
      ]
    },
    {
      "name": "Buyer Purchase & Secure Delivery",
      "description": "Public checkout flow: buyer initiates payment from storefront, Razorpay handles payment UI, server verifies webhook, creates order and sends S3-signed download link via email (SendGrid).",
      "user_flows": [
        "Navigate to /u/[username] -> Click product card -> Click 'Buy Now' -> Fill email on checkout form -> Click 'Proceed to payment' -> Razorpay checkout opens -> Complete payment successfully -> Razorpay webhook hits /api/webhooks/razorpay -> Server verifies signature -> Server creates Order and generates S3 signed URL -> SendGrid sends confirmation email with download link -> Buyer sees success page with download button",
        "Navigate to /u/[username] -> Click product card -> Click 'Buy Now' -> Fill email -> Click 'Proceed to payment' -> Razorpay checkout opens -> Payment fails or cancelled -> Buyer sees 'Payment failed' message -> No order created",
        "Navigate to /u/[username] -> Buy product -> Payment succeeds but webhook signature invalid -> /api/webhooks/razorpay returns 400 'Invalid signature' -> Order not created -> System logs webhook in WebhookLog and alerts admin"
      ]
    },
    {
      "name": "Billing & Subscription (Razorpay)",
      "description": "Subscription creation with 14-day trial via Razorpay mandates, webhook-driven lifecycle handling (subscription.activated, subscription.charged, payment.failed) and admin-visible webhook logs.",
      "user_flows": [
        "Navigate to /onboarding -> Select plan and click 'Start Trial' -> Complete Razorpay mandate -> Razorpay returns confirmation -> subscription.created in DB -> Day 14: Razorpay charges -> webhook subscription.charged -> Server updates subscription.status to active -> Creator receives welcome email -> Dashboard shows full features",
        "Navigate to /dashboard -> Open Billing page -> Click 'Cancel subscription' -> POST /api/subscription/cancel called -> Server sets cancelAtPeriodEnd true -> See 'Cancelled at period end' confirmation",
        "Navigate to /onboarding -> Start trial and provide payment method -> Razorpay charge fails on Day 14 -> webhook payment.failed triggers -> Server sets subscription.status = past_due -> Creator receives 'Payment failed' email -> Access downgraded after grace period"
      ]
    },
    {
      "name": "AutoDM Hub (Instagram follow-first logic)",
      "description": "Creators configure AutoDM rules in dashboard to send product links or files when triggers occur (comment, story reply, new follower). Follow-first logic stores pending requests and sends content when the user follows.",
      "user_flows": [
        "Navigate to /dashboard -> Click 'AutoDM' -> Click 'Create Rule' -> Enter trigger 'keyword=link' and enable follow-first -> Click 'Save' -> See rule listed in rules table",
        "Visitor comments 'link' on Instagram post -> Meta webhook /api/webhooks/instagram receives comment event -> Server checks rule and keyword match -> Server checks follower status via Instagram Graph API -> If not following -> Save request to autodm_pending and queue 'follow-first' DM -> User follows creator -> Meta follower webhook received -> Server finds pending entry -> Add product link DM to send queue -> DM sent via Graph API",
        "Visitor comments 'link' repeatedly -> Server detects deduplication (DM already sent within 24h) -> Ignore duplicate -> Log deduplication event",
        "Visitor comments 'link' -> Meta webhook processed -> Server attempts to send DM but Instagram rate limit hit -> Message queued and retried 3 times with backoff -> After retries fail -> Mark DM as failed and notify creator"
      ]
    },
    {
      "name": "Admin Panel",
      "description": "Platform administrators manage users, update plan prices (syncing to Razorpay), inspect webhook logs, and perform account actions (suspend/impersonate) from /admin.",
      "user_flows": [
        "Navigate to /admin -> Authenticate as admin -> Open 'Users' list -> Search for a creator -> Click 'Suspend' -> Confirm suspend -> See 'User suspended' status in list",
        "Navigate to /admin -> Open 'Plans' -> Edit price for a plan -> Click 'Save' -> Server updates plans collection and calls Razorpay API to sync price -> See 'Price sync successful' confirmation",
        "Navigate to /admin -> Open 'Webhooks' -> View webhook entry -> Click 'Reprocess' -> Server reprocesses webhook -> If signature invalid -> See 'Invalid signature' error and do not reprocess"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "Next.js",
      "Lucide React",
      "Framer Motion",
      "Tailwind CSS",
      "Clerk (Auth)",
      "MongoDB/Mongoose",
      "AWS SDK (S3)",
      "@dnd-kit (Storefront Editor)"
    ],
    "routes": [
      {
        "path": "/u/[username]",
        "file": "src/app/u/[username]/page.tsx",
        "auth_required": false,
        "description": "Public storefront displaying creator bio, links, and products"
      },
      {
        "path": "/dashboard/storefront",
        "file": "src/app/(dashboard)/dashboard/storefront/page.tsx",
        "auth_required": true,
        "description": "Creator dashboard for editing storefront theme, layout, and links"
      },
      {
        "path": "/onboarding",
        "file": "src/app/onboarding/page.tsx",
        "auth_required": true,
        "description": "User onboarding flow for new creators"
      },
      {
        "path": "/dashboard",
        "file": "src/app/(dashboard)/dashboard/page.tsx",
        "auth_required": true,
        "description": "Main creator dashboard overview"
      },
      {
        "path": "/admin",
        "file": "src/app/admin/page.tsx",
        "auth_required": true,
        "description": "Platform administrator panel"
      }
    ],
    "features": [
      {
        "name": "Public Storefront",
        "description": "Public profile for creators to showcase their work and sell products",
        "files": [
          "src/app/u/[username]/page.tsx",
          "src/components/storefront/CreatorBio.tsx",
          "src/components/storefront/ProductGrid.tsx"
        ],
        "entry_route": "/u/[username]",
        "user_interactions": [
          "View creator bio and social links",
          "Switch between Grid and List product layouts",
          "Click product cards to view details"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/public/[username]"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Storefront Customization",
        "description": "Editor for creators to customize their storefront theme and layout",
        "files": [
          "src/app/(dashboard)/dashboard/storefront/page.tsx",
          "src/lib/models/CreatorProfile.ts"
        ],
        "entry_route": "/dashboard/storefront",
        "user_interactions": [
          "Change primary and background colors",
          "Upload background image",
          "Toggle profile photo visibility",
          "Reorder storefront sections with drag-and-drop",
          "Click Save to persist changes"
        ],
        "api_calls": [
          {
            "method": "GET",
            "endpoint": "/api/creator/profile"
          },
          {
            "method": "PATCH",
            "endpoint": "/api/creator/profile"
          },
          {
            "method": "POST",
            "endpoint": "/api/creator/upload"
          }
        ],
        "auth_required": true
      }
    ],
    "known_limitations": [
      {
        "issue": "Background image upload requires S3 configuration",
        "location": "src/app/api/creator/upload/route.ts",
        "impact": "Uploads will fail if S3 credentials are not set in environment"
      }
    ]
  }
}
